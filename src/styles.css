/* ===========================
   Design Tokens (Mobile-first)
   =========================== */
:root{
  /* 颜色 */
  --bg:#fafafa; --card:#fff; --muted:#666; --border:#e9e9e9; --text:#1f2328;
  --brand:#1f6feb; --ok:#12805c30; --bad:#e5484d2a;

  /* 尺度（移动端优先） */
  --space-1: 6px;
  --space-2: 10px;
  --space-3: 12px;
  --space-4: 16px;
  --space-5: 20px;
  --space-6: 24px;

  --radius-sm: 10px;
  --radius-md: 14px;
  --radius-lg: 18px;

  --shadow-sm: 0 2px 8px rgba(0,0,0,.06);
  --shadow-md: 0 8px 20px rgba(0,0,0,.04);

  /* 焦点环 */
  --ring: 2px solid #1f6feb55;
  --ring-strong: 2px solid #1f6febaa;

  /* 安全区 */
  --safe-top: env(safe-area-inset-top);
  --safe-bottom: env(safe-area-inset-bottom);
}

/* 基线 */
*{box-sizing:border-box}
html,body,#root{height:100%}
body{
  margin:0;background:var(--bg);color:var(--text);
  font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
}

/* ===========================
   Layout & Containers
   =========================== */

/* 容器：移动端左右留白更紧凑，保留一个最大宽度以便平板 */
.container{
  max-width: 720px;
  margin: 0 auto;
  padding: var(--space-5) var(--space-4);
}

/* 顶栏：吸顶 + 安全区避让 + 轻微毛玻璃 */
.header{
  position: sticky; top: 0;
  background: var(--bg);
  padding-top: var(--safe-top);
  backdrop-filter: saturate(180%) blur(8px);
  z-index: 10;
  border-bottom: 1px solid var(--border);
}
.header-inner{
  display:flex;align-items:center;justify-content:space-between;gap:var(--space-3);
  padding: var(--space-3) var(--space-4);
}
.brand{display:flex;align-items:center;gap:10px;font-weight:700}
.brand-badge{width:28px;height:28px;border-radius:8px;background:var(--brand);box-shadow:0 2px 8px #0001}

/* 网格：手机默认单列；到中等宽度再自适应 */
.grid{
  display:grid;
  grid-template-columns: 1fr;
  gap: var(--space-4);
}
@media (min-width: 520px){
  .grid{ grid-template-columns: repeat(2, 1fr); }
}
@media (min-width: 860px){
  .grid{ grid-template-columns: repeat(3, 1fr); }
}

.card{
  background:var(--card);
  border:1px solid var(--border);
  border-radius:var(--radius-md);
  padding:var(--space-4);
  box-shadow:var(--shadow-md);
}
.card h3{margin:6px 0 8px}
.note{color:var(--muted);font-size:14px}
.badge{
  display:inline-flex;align-items:center;gap:6px;
  padding:2px 8px;border-radius:999px;background:#f4f6f8;
  font-size:12px;border:1px solid var(--border)
}
.hr{height:1px;background:var(--border);margin:20px 0}

/* ===========================
   Buttons
   =========================== */
.button{
  display:inline-flex;align-items:center;justify-content:center;gap:8px;
  padding:10px 16px;
  min-height:44px; /* 触控尺寸 */
  min-width:44px;
  border:1px solid var(--text);
  border-radius:var(--radius-sm);
  text-decoration:none;color:var(--text);background:#fff;
  cursor:pointer;
  transition:transform .06s ease, box-shadow .15s ease, background .15s;
  -webkit-tap-highlight-color: transparent;
}
.button.primary{background:var(--text);color:#fff}
.button:hover{transform:translateY(-1px);box-shadow:0 6px 14px rgba(0,0,0,.06)}
.button:active{transform:translateY(0);box-shadow:none}
.button:disabled{opacity:.5;cursor:not-allowed}
.button.sm{padding:6px 10px;font-size:14px}
.button.lg{padding:12px 18px;font-size:16px}
.actions{display:flex;gap:8px;flex-wrap:wrap}

/* ===========================
   Question Choices
   =========================== */
.choice{
  display:flex;align-items:center;gap:10px;
  padding:12px var(--space-4);
  min-height: 44px; /* 触控区域 */
  border-radius:var(--radius-sm);
  border:1px solid var(--border);
  margin:8px 0;cursor:pointer;
  transition:background .15s,border .15s, box-shadow .15s;
}
.choice:hover{border-color:#bbb;background:#f9f9f9}
.choice input{accent-color:var(--text)}
.correct{background:#E8F5EF;border-color:#0f7b58}
.incorrect{background:#FDEBEC;border-color:#e5484d}
/* 小屏阅读更舒适的行高 */
.choice p{margin:0; line-height:1.6}

/* ===========================
   Progress & Navigator
   =========================== */
.progressbar{height:8px;background:#eee;border-radius:999px;overflow:hidden}
.progressbar>span{display:block;height:100%;background:var(--brand)}

.navbar{display:flex;gap:6px;flex-wrap:wrap}
.navbtn{
  min-width:36px;height:36px;
  border:1px solid var(--border);
  border-radius:8px;background:#fff;cursor:pointer;
  transition:box-shadow .15s, transform .06s;
}
.navbtn:hover{transform:translateY(-1px)}
.navbtn.active{border-color:var(--brand); box-shadow:0 0 0 2px #1f6feb22 inset}
.navbtn.ok{background:#e6f7ef;border-color:#0f7b58}
.navbtn.err{background:#ffecec;border-color:#e5484d}

/* ===========================
   Sticky Actions & Safe Area
   =========================== */
.sticky-actions{
  position:sticky;bottom:0;
  background:var(--bg);
  border-top:1px solid var(--border);
  padding: var(--space-3) 0 calc(var(--space-3) + var(--safe-bottom));
  margin-top:8px;
  backdrop-filter:saturate(180%) blur(8px);
  box-shadow:0 -6px 18px rgba(0,0,0,.04)
}

/* ===========================
   Forms
   =========================== */
.input{
  padding:10px 12px;
  min-height: 44px; /* 触控尺寸 */
  border:1px solid var(--border);
  border-radius:var(--radius-sm);
  background:#fff;color:var(--text);outline:none;
  transition:border .15s, box-shadow .15s;
}
.input::placeholder{color:#9aa6b2}
.input:focus{border-color:#b6c3d1; box-shadow:0 0 0 3px #1f6feb1a}

/* ===========================
   A11y & Focus
   =========================== */
:focus{outline:none}
:focus-visible{outline: var(--ring)}
.button:focus-visible{box-shadow:0 0 0 3px #1f6feb22}
.choice:focus-within{outline: var(--ring-strong)}
.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}

/* ===========================
   Dark Scheme (auto)
   =========================== */
@media (prefers-color-scheme: dark){
  :root{
    --bg:#0d1117; --card:#161b22; --muted:#9aa6b2; --border:#30363d; --text:#e6edf3;
    --brand:#2f81f7; --ok:#12805c40; --bad:#e5484d35;
  }
  .button{background:var(--card)}
  .badge{background:#0f141b}
  .choice:hover{background:#121820;border-color:#3a4048}
}

/* 手动暗色（如有主题切换器时） */
html[data-theme="dark"]{
  --bg:#0d1117; --card:#161b22; --muted:#9aa6b2; --border:#30363d; --text:#e6edf3; --brand:#2f81f7; --ok:#12805c40; --bad:#e5484d35;
}

/* ===========================
   Sections & States
   =========================== */
.card .section-title{
  font-weight:600;margin:10px 0 6px;color:var(--muted);
  text-transform:uppercase;letter-spacing:.02em;font-size:12px
}
.card .divider{height:1px;background:var(--border);margin:10px 0}
.state{
  display:flex;flex-direction:column;align-items:center;gap:8px;
  padding:24px;border:1px dashed var(--border);
  border-radius:var(--radius-md);background:var(--card)
}
.state .title{font-weight:600}
.state .desc{color:var(--muted);font-size:14px}

/* ===========================
   Motion Preference
   =========================== */
@media (prefers-reduced-motion: reduce){
  *{animation:none!important;transition:none!important}
}

/* 公式字号微调，和正文字号更协调 */
.katex { font-size: 1.02em; }

/* 多选漏选的正确项：黄色提示 */
.partial {
  background: #fff8e1;
  border-color: #f6c453;
}
